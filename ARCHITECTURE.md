# Texas Hold'em AI Battle Simulator - Architecture Design

**Version**: 1.0  
**Date**: 2025-11-13  
**Backend**: Python-based Local System

---

## 1. System Overview

### 1.1 Architecture Pattern
**Monolithic Modular Architecture** with clear service boundaries, suitable for local deployment with potential for future microservices migration.

### 1.2 Core Components
```
┌─────────────────────────────────────────────────────────────┐
│                    Frontend Layer                            │
│  React 18 + TypeScript + TailwindCSS + Socket.io-client     │
└────────────────┬────────────────────────────────────────────┘
                 │ HTTP/WebSocket
┌────────────────▼────────────────────────────────────────────┐
│                   API Gateway Layer                          │
│          FastAPI + WebSocket Manager                         │
├──────────────────────────────────────────────────────────────┤
│                   Business Logic Layer                       │
│  ┌──────────────┬──────────────┬──────────────┬───────────┐ │
│  │ Game Engine  │ AI Manager   │ Analytics    │ Admin     │ │
│  │ Service      │ Service      │ Service      │ Service   │ │
│  └──────────────┴──────────────┴──────────────┴───────────┘ │
├──────────────────────────────────────────────────────────────┤
│                   Data Layer                                 │
│  ┌──────────────┬──────────────┬──────────────┐            │
│  │ PostgreSQL   │ Redis Cache  │ File Storage │            │
│  └──────────────┴──────────────┴──────────────┘            │
└──────────────────────────────────────────────────────────────┘
                 │
┌────────────────▼────────────────────────────────────────────┐
│              External AI Agents (REST/WebSocket)            │
└─────────────────────────────────────────────────────────────┘
```

---

## 2. Technology Stack

### 2.1 Backend Stack
| Component | Technology | Version | Purpose |
|-----------|-----------|---------|---------|
| **Web Framework** | FastAPI | 0.104+ | Async REST API + WebSocket |
| **Language** | Python | 3.11+ | Core backend language |
| **Database** | PostgreSQL | 15+ | Primary data storage |
| **Cache** | Redis | 7.0+ | Game state, session cache |
| **ORM** | SQLAlchemy | 2.0+ | Database abstraction |
| **Migration** | Alembic | 1.12+ | Database migrations |
| **Task Queue** | Celery + Redis | 5.3+ | Async tasks, analysis jobs |
| **WebSocket** | python-socketio | 5.10+ | Real-time communication |
| **HTTP Client** | httpx | 0.25+ | AI agent communication |
| **Validation** | Pydantic | 2.5+ | Data validation |
| **Testing** | pytest | 7.4+ | Unit & integration tests |
| **Logging** | structlog | 23.2+ | Structured logging |

### 2.2 Frontend Stack
| Component | Technology | Version | Purpose |
|-----------|-----------|---------|---------|
| **Framework** | React | 18.2+ | UI framework |
| **Language** | TypeScript | 5.0+ | Type safety |
| **Styling** | TailwindCSS | 3.3+ | Utility-first CSS |
| **State** | Zustand | 4.4+ | Lightweight state mgmt |
| **Animation** | Framer Motion | 10.16+ | Smooth animations |
| **HTTP Client** | Axios | 1.6+ | API communication |
| **WebSocket** | Socket.io-client | 4.6+ | Real-time events |
| **Charts** | Recharts | 2.10+ | Data visualization |
| **UI Components** | Headless UI | 1.7+ | Accessible components |

### 2.3 Development Tools
- **Package Manager**: Poetry (Python), pnpm (Frontend)
- **Code Quality**: Black, isort, flake8, pylint
- **Type Checking**: mypy
- **API Documentation**: Swagger UI (auto-generated by FastAPI)
- **Version Control**: Git

---

## 3. Backend Architecture

### 3.1 Project Structure
```
poker-simulator/
├── backend/
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                 # FastAPI application entry
│   │   ├── config.py               # Configuration management
│   │   ├── dependencies.py         # Dependency injection
│   │   │
│   │   ├── api/                    # API layer
│   │   │   ├── __init__.py
│   │   │   ├── v1/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── endpoints/
│   │   │   │   │   ├── game.py     # Game management
│   │   │   │   │   ├── ai.py       # AI management
│   │   │   │   │   ├── player.py   # Player actions
│   │   │   │   │   ├── admin.py    # Admin operations
│   │   │   │   │   └── analytics.py # Data analytics
│   │   │   │   └── router.py
│   │   │   └── websocket/
│   │   │       ├── __init__.py
│   │   │       ├── manager.py      # WebSocket connection manager
│   │   │       └── handlers.py     # WebSocket event handlers
│   │   │
│   │   ├── core/                   # Core business logic
│   │   │   ├── __init__.py
│   │   │   ├── game_engine/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── engine.py       # Main game engine
│   │   │   │   ├── deck.py         # Deck management
│   │   │   │   ├── hand_evaluator.py # Hand ranking
│   │   │   │   ├── pot_manager.py  # Pot & side pot calculation
│   │   │   │   ├── betting.py      # Betting logic
│   │   │   │   └── rules.py        # Game rules
│   │   │   │
│   │   │   ├── ai_manager/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── manager.py      # AI lifecycle management
│   │   │   │   ├── client.py       # AI HTTP/WS client
│   │   │   │   ├── strategies/
│   │   │   │   │   ├── __init__.py
│   │   │   │   │   ├── base.py     # Base strategy interface
│   │   │   │   │   ├── aggressive.py # LAG strategy
│   │   │   │   │   ├── conservative.py # TAG strategy
│   │   │   │   │   ├── balanced.py  # GTO strategy
│   │   │   │   │   ├── random.py    # Random strategy
│   │   │   │   │   └── adaptive.py  # Adaptive strategy
│   │   │   │   └── timeout_handler.py # Timeout management
│   │   │   │
│   │   │   ├── analytics/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── stats_calculator.py # Real-time stats
│   │   │   │   ├── hand_analyzer.py    # Hand analysis
│   │   │   │   ├── position_analyzer.py # Position analysis
│   │   │   │   └── gto_analyzer.py     # GTO deviation
│   │   │   │
│   │   │   └── admin/
│   │   │       ├── __init__.py
│   │   │       ├── ai_config.py    # AI configuration
│   │   │       ├── optimizer.py    # Strategy optimizer
│   │   │       └── report_generator.py # Report generation
│   │   │
│   │   ├── models/                 # Database models
│   │   │   ├── __init__.py
│   │   │   ├── game.py
│   │   │   ├── player.py
│   │   │   ├── hand.py
│   │   │   ├── action.py
│   │   │   ├── ai_config.py
│   │   │   └── statistics.py
│   │   │
│   │   ├── schemas/                # Pydantic schemas
│   │   │   ├── __init__.py
│   │   │   ├── game.py
│   │   │   ├── player.py
│   │   │   ├── action.py
│   │   │   ├── ai.py
│   │   │   └── analytics.py
│   │   │
│   │   ├── services/               # Business services
│   │   │   ├── __init__.py
│   │   │   ├── game_service.py
│   │   │   ├── player_service.py
│   │   │   ├── ai_service.py
│   │   │   └── analytics_service.py
│   │   │
│   │   ├── repositories/           # Data access layer
│   │   │   ├── __init__.py
│   │   │   ├── game_repository.py
│   │   │   ├── player_repository.py
│   │   │   └── statistics_repository.py
│   │   │
│   │   ├── utils/                  # Utilities
│   │   │   ├── __init__.py
│   │   │   ├── cache.py            # Redis utilities
│   │   │   ├── logger.py           # Logging setup
│   │   │   ├── security.py         # API key validation
│   │   │   └── helpers.py          # Helper functions
│   │   │
│   │   └── db/                     # Database
│   │       ├── __init__.py
│   │       ├── session.py          # DB session management
│   │       └── base.py             # Base model
│   │
│   ├── alembic/                    # Database migrations
│   │   ├── versions/
│   │   └── env.py
│   │
│   ├── tests/                      # Test suite
│   │   ├── unit/
│   │   ├── integration/
│   │   └── conftest.py
│   │
│   ├── scripts/                    # Utility scripts
│   │   ├── init_db.py
│   │   └── seed_data.py
│   │
│   ├── pyproject.toml              # Poetry dependencies
│   ├── alembic.ini                 # Alembic config
│   ├── .env.example
│   └── README.md
│
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── game/
│   │   │   │   ├── PokerTable.tsx
│   │   │   │   ├── PlayerCard.tsx
│   │   │   │   ├── CommunityCards.tsx
│   │   │   │   ├── PotDisplay.tsx
│   │   │   │   └── ActionPanel.tsx
│   │   │   ├── admin/
│   │   │   │   ├── Dashboard.tsx
│   │   │   │   ├── AIConfig.tsx
│   │   │   │   ├── Analytics.tsx
│   │   │   │   └── StrategyOptimizer.tsx
│   │   │   └── common/
│   │   │       ├── Button.tsx
│   │   │       ├── Card.tsx
│   │   │       └── Modal.tsx
│   │   ├── hooks/
│   │   │   ├── useGame.ts
│   │   │   ├── useWebSocket.ts
│   │   │   └── usePlayer.ts
│   │   ├── stores/
│   │   │   ├── gameStore.ts
│   │   │   └── playerStore.ts
│   │   ├── services/
│   │   │   ├── api.ts
│   │   │   └── websocket.ts
│   │   ├── types/
│   │   │   └── index.ts
│   │   ├── utils/
│   │   │   └── helpers.ts
│   │   ├── App.tsx
│   │   └── main.tsx
│   ├── public/
│   ├── package.json
│   └── vite.config.ts
│
└── docs/
    ├── API.md
    ├── DATABASE.md
    └── DEPLOYMENT.md
```

---

## 4. Core Modules Design

### 4.1 Game Engine Module

#### 4.1.1 Game State Machine
```python
from enum import Enum

class GamePhase(Enum):
    WAITING = "waiting"
    PRE_FLOP = "pre_flop"
    FLOP = "flop"
    TURN = "turn"
    RIVER = "river"
    SHOWDOWN = "showdown"
    COMPLETE = "complete"

class GameEngine:
    """
    Core game engine managing the complete poker game lifecycle.
    Responsibilities:
    - Game state management
    - Player action validation
    - Pot calculation (main pot + side pots)
    - Winner determination
    - Hand history recording
    """
```

#### 4.1.2 Hand Evaluator
- **Algorithm**: Optimized 7-card evaluation using lookup tables
- **Performance**: O(1) evaluation time
- **Support**: All standard poker hands (High Card to Royal Flush)

#### 4.1.3 Pot Manager
- Main pot calculation
- Side pot creation for all-in scenarios
- Multi-way pot distribution
- Rake handling (if applicable)

### 4.2 AI Manager Module

#### 4.2.1 AI Client Interface
```python
class AIClient(ABC):
    """Abstract base class for AI communication"""
    
    @abstractmethod
    async def get_decision(
        self, 
        game_state: GameState
    ) -> PlayerAction:
        """Send game state and receive decision"""
        pass
    
    @abstractmethod
    async def health_check(self) -> bool:
        """Check AI availability"""
        pass
```

#### 4.2.2 Built-in AI Strategies

**Strategy Implementation**:
```python
class AIStrategy:
    """Base strategy class with configurable parameters"""
    
    vpip: float          # Voluntarily Put In Pot %
    pfr: float           # Pre-Flop Raise %
    three_bet: float     # 3-Bet %
    cbet: float          # Continuation Bet %
    aggression_factor: float  # AF
    
    def decide(
        self,
        hand: List[Card],
        community: List[Card],
        pot: int,
        current_bet: int,
        position: Position,
        opponents: List[OpponentProfile]
    ) -> Action:
        """Make decision based on strategy parameters"""
```

**Pre-configured Strategies**:
1. **Aggressive (LAG)**: VPIP 45%, PFR 35%, 3-Bet 12%
2. **Conservative (TAG)**: VPIP 18%, PFR 15%, 3-Bet 5%
3. **Balanced (GTO)**: VPIP 27%, PFR 21%, 3-Bet 8%
4. **Random**: Random actions with basic validity checks
5. **Adaptive**: Dynamic adjustment based on opponent modeling

#### 4.2.3 Timeout Handling
- Default timeout: 5 seconds
- Configurable per AI
- Auto-fold on timeout
- Retry mechanism with exponential backoff

### 4.3 Analytics Module

#### 4.3.1 Real-time Statistics
- **VPIP**: Voluntarily Put In Pot rate
- **PFR**: Pre-Flop Raise rate
- **3-Bet**: 3-Bet percentage
- **AF**: Aggression Factor (Bet+Raise / Call)
- **W$SD**: Win rate at showdown
- **WTSD**: Went To Showdown rate

#### 4.3.2 Hand Analysis
- Starting hand strength evaluation
- Position-based profitability
- Hand range analysis
- Equity calculations

#### 4.3.3 GTO Deviation Analysis
- Compare decisions against GTO solver
- Calculate EV loss
- Identify strategic mistakes
- Generate improvement suggestions

### 4.4 Admin Module

#### 4.4.1 AI Configuration Manager
- Register/update AI endpoints
- Configure strategy parameters
- Set timeout and retry policies
- Health monitoring

#### 4.4.2 Strategy Optimizer
- A/B testing framework
- Monte Carlo simulation (100k+ hands)
- Parameter tuning suggestions
- Performance comparison

#### 4.4.3 Report Generator
- Game session reports
- AI performance reports
- Strategy comparison reports
- Export to PDF/CSV

---

## 5. Database Design

### 5.1 Schema Overview

```sql
-- AI Configuration
CREATE TABLE ai_configurations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    version VARCHAR(20) NOT NULL,
    description TEXT,
    connection_type VARCHAR(20) NOT NULL, -- REST, WebSocket, Local
    endpoint VARCHAR(500),
    auth_config JSONB,
    timeout_ms INTEGER DEFAULT 5000,
    retry_policy JSONB,
    strategy_config JSONB NOT NULL,
    capabilities JSONB,
    status VARCHAR(20) DEFAULT 'active',
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(name, version)
);

-- Game Sessions
CREATE TABLE games (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    game_type VARCHAR(20) DEFAULT 'NLH',
    small_blind INTEGER NOT NULL,
    big_blind INTEGER NOT NULL,
    max_players INTEGER NOT NULL,
    status VARCHAR(20) NOT NULL,
    current_phase VARCHAR(20),
    dealer_position INTEGER,
    created_at TIMESTAMP DEFAULT NOW(),
    started_at TIMESTAMP,
    ended_at TIMESTAMP
);

-- Players in Game
CREATE TABLE game_players (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    game_id UUID NOT NULL REFERENCES games(id) ON DELETE CASCADE,
    player_id UUID,
    ai_config_id UUID REFERENCES ai_configurations(id),
    player_type VARCHAR(20) NOT NULL, -- human, ai
    position INTEGER NOT NULL,
    stack INTEGER NOT NULL,
    initial_stack INTEGER NOT NULL,
    status VARCHAR(20) DEFAULT 'active',
    joined_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(game_id, position)
);

-- Hand History
CREATE TABLE hands (
    id BIGSERIAL PRIMARY KEY,
    game_id UUID NOT NULL REFERENCES games(id) ON DELETE CASCADE,
    hand_number INTEGER NOT NULL,
    dealer_position INTEGER NOT NULL,
    small_blind_amount INTEGER NOT NULL,
    big_blind_amount INTEGER NOT NULL,
    community_cards JSONB,
    pot_total INTEGER NOT NULL,
    rake INTEGER DEFAULT 0,
    started_at TIMESTAMP DEFAULT NOW(),
    ended_at TIMESTAMP,
    UNIQUE(game_id, hand_number)
);

-- Player Actions
CREATE TABLE actions (
    id BIGSERIAL PRIMARY KEY,
    hand_id BIGINT NOT NULL REFERENCES hands(id) ON DELETE CASCADE,
    game_player_id UUID NOT NULL REFERENCES game_players(id),
    action_type VARCHAR(20) NOT NULL, -- fold, check, call, bet, raise, all_in
    amount INTEGER,
    phase VARCHAR(20) NOT NULL,
    action_sequence INTEGER NOT NULL,
    thinking_time_ms INTEGER,
    timestamp TIMESTAMP DEFAULT NOW()
);

-- Hand Results
CREATE TABLE hand_results (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    hand_id BIGINT NOT NULL REFERENCES hands(id) ON DELETE CASCADE,
    game_player_id UUID NOT NULL REFERENCES game_players(id),
    hand_cards JSONB NOT NULL,
    hand_rank VARCHAR(50),
    best_hand JSONB,
    amount_won INTEGER DEFAULT 0,
    is_winner BOOLEAN DEFAULT FALSE
);

-- AI Performance Statistics
CREATE TABLE ai_statistics (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    ai_config_id UUID NOT NULL REFERENCES ai_configurations(id),
    period_start DATE NOT NULL,
    period_end DATE NOT NULL,
    hands_played INTEGER DEFAULT 0,
    vpip DECIMAL(5,2),
    pfr DECIMAL(5,2),
    three_bet DECIMAL(5,2),
    cbet DECIMAL(5,2),
    af DECIMAL(5,2),
    wtsd DECIMAL(5,2),
    w_sd DECIMAL(5,2),
    bb_per_100 DECIMAL(10,2),
    total_profit INTEGER,
    avg_response_time_ms INTEGER,
    timeout_count INTEGER DEFAULT 0,
    error_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(ai_config_id, period_start, period_end)
);

-- Hand Analysis Cache
CREATE TABLE hand_analysis (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    hand_id BIGINT NOT NULL REFERENCES hands(id) ON DELETE CASCADE,
    analysis_type VARCHAR(50) NOT NULL,
    analysis_data JSONB NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

-- System Audit Log
CREATE TABLE audit_logs (
    id BIGSERIAL PRIMARY KEY,
    user_id UUID,
    action VARCHAR(100) NOT NULL,
    entity_type VARCHAR(50),
    entity_id UUID,
    changes JSONB,
    ip_address INET,
    timestamp TIMESTAMP DEFAULT NOW()
);

-- Indexes for performance
CREATE INDEX idx_games_status ON games(status);
CREATE INDEX idx_games_created_at ON games(created_at DESC);
CREATE INDEX idx_hands_game_id ON hands(game_id);
CREATE INDEX idx_actions_hand_id ON actions(hand_id);
CREATE INDEX idx_ai_stats_ai_id_period ON ai_statistics(ai_config_id, period_start DESC);
CREATE INDEX idx_audit_logs_timestamp ON audit_logs(timestamp DESC);
```

### 5.2 Redis Cache Strategy

**Cache Keys**:
```
game:{game_id}:state          # Current game state (TTL: 24h)
game:{game_id}:players        # Player list (TTL: 24h)
ai:{ai_id}:health             # AI health status (TTL: 60s)
session:{session_id}          # User session (TTL: 30m)
stats:{ai_id}:realtime        # Real-time stats (TTL: 5m)
```

---

## 6. API Design

### 6.1 REST API Endpoints

#### Game Management
```
POST   /api/v1/games                    # Create game
GET    /api/v1/games/{game_id}          # Get game details
PUT    /api/v1/games/{game_id}/start    # Start game
DELETE /api/v1/games/{game_id}          # Delete game
GET    /api/v1/games                    # List games
```

#### Player Actions
```
POST   /api/v1/games/{game_id}/join     # Join game
POST   /api/v1/games/{game_id}/action   # Submit action
GET    /api/v1/games/{game_id}/state    # Get game state
```

#### AI Management
```
POST   /api/v1/ai/register               # Register AI
GET    /api/v1/ai                         # List AIs
GET    /api/v1/ai/{ai_id}                 # Get AI details
PUT    /api/v1/ai/{ai_id}                 # Update AI config
DELETE /api/v1/ai/{ai_id}                 # Delete AI
POST   /api/v1/ai/{ai_id}/health-check   # Check AI health
```

#### Analytics
```
GET    /api/v1/analytics/ai/{ai_id}/stats        # AI statistics
GET    /api/v1/analytics/hands/{hand_id}         # Hand analysis
GET    /api/v1/analytics/games/{game_id}/report  # Game report
GET    /api/v1/analytics/comparison              # Compare AIs
```

#### Admin
```
GET    /api/v1/admin/dashboard           # Dashboard data
POST   /api/v1/admin/optimize            # Run optimizer
GET    /api/v1/admin/audit-logs          # Audit logs
```

### 6.2 WebSocket Events

#### Client → Server
```javascript
// Join game room
socket.emit('join_game', { gameId, playerId, token });

// Submit action
socket.emit('player_action', { 
    gameId, 
    playerId, 
    action: 'raise', 
    amount: 500 
});

// Request game state
socket.emit('get_state', { gameId });
```

#### Server → Client
```javascript
// Game started
socket.on('game_started', { gameId, players, blinds });

// Player action occurred
socket.on('player_action', { 
    playerId, 
    action, 
    amount, 
    newPot 
});

// Phase changed
socket.on('phase_changed', { 
    phase, 
    communityCards 
});

// Hand complete
socket.on('hand_complete', { 
    winners, 
    pots, 
    results 
});

// Game state update
socket.on('state_update', { fullState });

// Error occurred
socket.on('error', { code, message });
```

### 6.3 External AI API (What AI agents implement)

#### AI Decision Endpoint
```http
POST {ai_endpoint}/decision
Content-Type: application/json
Authorization: Bearer {api_key}

{
  "gameId": "uuid",
  "handId": 123,
  "round": "flop",
  "pot": 1500,
  "communityCards": ["As", "Kh", "9d"],
  "playerHand": ["Ac", "Kd"],
  "position": 3,
  "stack": 4500,
  "players": [
    {
      "id": "p1",
      "position": 1,
      "stack": 5000,
      "currentBet": 500,
      "status": "active"
    }
  ],
  "currentBet": 500,
  "minRaise": 1000,
  "maxRaise": 4500,
  "availableActions": ["fold", "call", "raise", "all-in"],
  "potOdds": 0.33,
  "history": [...]
}

Response:
{
  "action": "raise",
  "amount": 1500,
  "thinkingTime": 2.3
}
```

---

## 7. Security & Performance

### 7.1 Security Measures
- **API Authentication**: API key + JWT tokens
- **Rate Limiting**: 100 req/min per IP, 1000 req/min per API key
- **Input Validation**: Pydantic models for all inputs
- **SQL Injection**: ORM usage, parameterized queries
- **XSS Protection**: Content sanitization
- **CORS**: Configured for frontend origin only

### 7.2 Performance Optimization
- **Database Connection Pool**: 20 min, 100 max connections
- **Redis Caching**: Game state, AI health, statistics
- **Async Operations**: All I/O operations async
- **Background Tasks**: Celery for heavy computations
- **Database Indexes**: All foreign keys and query fields
- **Query Optimization**: Select only required fields

### 7.3 Monitoring
- **Logging**: Structured logs with correlation IDs
- **Metrics**: Response time, error rate, active games
- **Health Checks**: `/health` endpoint
- **Performance**: Database query time tracking

---

## 8. Development Workflow

### 8.1 Environment Setup
```bash
# Backend
cd backend
poetry install
poetry run alembic upgrade head
poetry run python scripts/init_db.py
poetry run uvicorn app.main:app --reload

# Frontend
cd frontend
pnpm install
pnpm dev
```

### 8.2 Database Migrations
```bash
# Create migration
alembic revision --autogenerate -m "description"

# Apply migration
alembic upgrade head

# Rollback
alembic downgrade -1
```

### 8.3 Testing Strategy
- **Unit Tests**: Individual functions and classes (>80% coverage)
- **Integration Tests**: API endpoints with test database
- **E2E Tests**: Complete game flow simulation
- **Load Tests**: Concurrent game performance

---

## 9. Deployment Architecture

### 9.1 Local Development Setup
```
┌─────────────────────────────────────────┐
│  Developer Machine (localhost)          │
│                                          │
│  ┌──────────────┐  ┌──────────────┐    │
│  │  Frontend    │  │  Backend     │    │
│  │  :3000       │  │  :8000       │    │
│  └──────────────┘  └──────────────┘    │
│                                          │
│  ┌──────────────┐  ┌──────────────┐    │
│  │ PostgreSQL   │  │   Redis      │    │
│  │  :5432       │  │   :6379      │    │
│  └──────────────┘  └──────────────┘    │
└─────────────────────────────────────────┘
```

### 9.2 Configuration Management
- **Environment Variables**: `.env` file
- **Secrets**: Never committed, use `.env.example`
- **Database**: Connection string in environment

---

## 10. Future Enhancements

### Phase 2 Features
- [ ] PLO (Pot Limit Omaha) support
- [ ] Tournament mode
- [ ] Hand range visualization
- [ ] GTO solver integration
- [ ] Machine learning AI training

### Phase 3 Features
- [ ] Multi-table support
- [ ] Real money simulation
- [ ] Mobile app
- [ ] Cloud deployment
- [ ] AI marketplace

---

## 11. Success Metrics

### Technical KPIs
- API response time: < 100ms (p95)
- WebSocket latency: < 50ms
- Game engine performance: 1000+ hands/second
- Database query time: < 20ms (p95)
- System uptime: > 99.5%

### Business KPIs
- Concurrent games supported: > 100
- AI response success rate: > 99%
- Hand evaluation accuracy: 100%
- User session duration: > 30 minutes
- Game completion rate: > 95%

---

## Appendix A: Card Representation

### Card Encoding
```python
# Suits: s (spades), h (hearts), d (diamonds), c (clubs)
# Ranks: 2-9, T (10), J, Q, K, A

Card = str  # e.g., "As" (Ace of Spades), "Kh" (King of Hearts)

class Card:
    rank: str  # '2'-'9', 'T', 'J', 'Q', 'K', 'A'
    suit: str  # 's', 'h', 'd', 'c'
```

### Hand Rankings (0 = High Card, 8 = Royal Flush)
0. High Card
1. One Pair
2. Two Pair
3. Three of a Kind
4. Straight
5. Flush
6. Full House
7. Four of a Kind
8. Straight Flush / Royal Flush

---

## Appendix B: Configuration Examples

### AI Configuration Example
```json
{
  "name": "AggressiveBot",
  "version": "1.0",
  "connectionType": "REST",
  "endpoint": "http://localhost:5000/decision",
  "authConfig": {
    "type": "bearer",
    "token": "secret_token"
  },
  "timeout": 5000,
  "strategyConfig": {
    "type": "LAG",
    "vpip": 45,
    "pfr": 35,
    "threeBet": 12,
    "cbet": 75,
    "aggressionFactor": 4.0
  }
}
```

### Game Configuration Example
```json
{
  "gameType": "NLH",
  "smallBlind": 5,
  "bigBlind": 10,
  "maxPlayers": 6,
  "buyIn": 1000,
  "players": [
    {
      "type": "human",
      "name": "Player1"
    },
    {
      "type": "ai",
      "aiConfigId": "ai_001"
    }
  ]
}
```

---

**End of Architecture Design Document**

